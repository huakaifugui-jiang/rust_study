/*
 * @Author: wlj
 * @Date: 2022-12-05 16:26:53
 * @LastEditors: wlj
 * @LastEditTime: 2022-12-05 17:49:13
 * @Description: ç»“æ„ä½“çš„å®šä¹‰å’Œå®ä¾‹åŒ–
 * @see:https://kaisery.github.io/trpl-zh-cn/ch05-01-defining-structs.html
 */
//ç»“æ„ä½“(struct)çš„å®šä¹‰å’Œå®ä¾‹åŒ–
//ç»“æ„ä½“ä¸å…ƒç»„ç±»ä¼¼ï¼Œå®ƒä»¬éƒ½åŒ…å«å¤šä¸ªç›¸å…³çš„å€¼ï¼Œæ¯ä¸€ä¸ªå€¼éƒ½å¯ä»¥æ˜¯ä¸åŒçš„ç±»å‹ã€‚
//ä½†ä¸ä¸€æ ·çš„æ˜¯ç»“æ„ä½“ éœ€è¦ å‘½å å„éƒ¨åˆ†æ•°æ®ä»¥ä¾¿èƒ½æ¸…æ¥šçš„è¡¨æ˜å…¶å€¼çš„æ„ä¹‰ã€‚
//ç”±äºæœ‰äº†è¿™äº›åå­—ï¼Œç»“æ„ä½“æ¯”å…ƒç»„æ›´çµæ´»ï¼šä¸éœ€è¦ä¾èµ–é¡ºåºæ¥æŒ‡å®šæˆ–è®¿é—®å®ä¾‹ä¸­çš„å€¼ã€‚ æ„Ÿè§‰åƒtsçš„æ¥å£ğŸ˜€

//å®šä¹‰ç»“æ„ä½“ï¼Œéœ€è¦ä½¿ç”¨ struct å…³é”®å­—å¹¶ä¸ºæ•´ä¸ªç»“æ„ä½“æä¾›ä¸€ä¸ªåå­—ã€‚ç»“æ„ä½“çš„åå­—éœ€è¦æè¿°å®ƒæ‰€ç»„åˆçš„æ•°æ®çš„æ„ä¹‰ã€‚æ¥ç€ï¼Œåœ¨å¤§æ‹¬å·ä¸­ï¼Œå®šä¹‰æ¯ä¸€éƒ¨åˆ†æ•°æ®çš„åå­—å’Œç±»å‹ï¼Œæˆ‘ä»¬ç§°ä¸º å­—æ®µï¼ˆfieldï¼‰
//ä¾‹å¦‚ä¸‹é¢ å±•ç¤ºäº†ä¸€ä¸ªå­˜å‚¨ç”¨æˆ·è´¦å·ä¿¡æ¯çš„ç»“æ„ä½“ï¼š
struct User {
    active: bool,
    username: String,
    email: String,
    sign_in_count: u64,
}

fn learn_struct() {
    //å¦‚ä½•ä½¿ç”¨ç»“æ„ä½“  é€šè¿‡ä¸ºæ¯ä¸ªå­—æ®µæŒ‡å®šå…·ä½“å€¼æ¥åˆ›å»ºè¿™ä¸ªç»“æ„ä½“çš„ å®ä¾‹ã€‚åˆ›å»ºä¸€ä¸ªå®ä¾‹éœ€è¦ä»¥ç»“æ„ä½“çš„åå­—å¼€å¤´ï¼Œæ¥ç€åœ¨å¤§æ‹¬å·ä¸­ä½¿ç”¨ key: value é”®-å€¼å¯¹çš„å½¢å¼æä¾›å­—æ®µï¼Œå…¶ä¸­ key æ˜¯å­—æ®µçš„åå­—ï¼Œvalue æ˜¯éœ€è¦å­˜å‚¨åœ¨å­—æ®µä¸­çš„æ•°æ®å€¼ã€‚
    //å®ä¾‹ä¸­å­—æ®µçš„é¡ºåºä¸éœ€è¦å’Œå®ƒä»¬åœ¨ç»“æ„ä½“ä¸­å£°æ˜çš„é¡ºåºä¸€è‡´ã€‚æ¢å¥è¯è¯´ï¼Œç»“æ„ä½“çš„å®šä¹‰å°±åƒä¸€ä¸ªç±»å‹çš„é€šç”¨æ¨¡æ¿ï¼Œè€Œå®ä¾‹åˆ™ä¼šåœ¨è¿™ä¸ªæ¨¡æ¿ä¸­æ”¾å…¥ç‰¹å®šæ•°æ®æ¥åˆ›å»ºè¿™ä¸ªç±»å‹çš„å€¼ã€‚
    let mut user1 = User {
        email: String::from("someone@example.com"),
        username: String::from("username"),
        active: true,
        sign_in_count: 1,
    };

    //ä¸ºäº†ä»ç»“æ„ä½“ä¸­è·å–æŸä¸ªç‰¹å®šçš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨ç‚¹å·ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæƒ³è¦ç”¨æˆ·çš„é‚®ç®±åœ°å€ï¼Œå¯ä»¥ç”¨ user1.emailã€‚å¦‚æœç»“æ„ä½“çš„å®ä¾‹æ˜¯å¯å˜çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç‚¹å·å¹¶ä¸ºå¯¹åº”çš„å­—æ®µèµ‹å€¼ã€‚
    //æ³¨æ„ æ•´ä¸ªuser1 å®ä¾‹å¿…é¡»æ˜¯å¯å˜çš„ï¼›Rustå¹¶ä¸å…è®¸åªå°†æŸä¸ªå­—æ®µæ ‡è®°ä¸ºå¯å˜ã€‚
    user1.email = String::from("anotheremail@example.com");
    println!("user email : {}", user1.email);

    //æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å‡½æ•°ä½“çš„æœ€åä¸€ä¸ªè¡¨è¾¾å¼ä¸­æ„é€ ä¸€ä¸ªç»“æ„ä½“çš„æ–°å®ä¾‹ï¼Œæ¥éšå¼çš„è¿”å›è¿™ä¸ªå®ä¾‹ã€‚
    learn_struct_back(String::from("test@email"), String::from("cxk"));

    //ä½¿ç”¨ç»“æ„ä½“æ›´æ–°è¯­æ³•  ä»å…¶ä»–å®ä¾‹åˆ›å»ºå®ä¾‹
    
    //ä½¿ç”¨æ—§å®ä¾‹çš„å¤§éƒ¨åˆ†å€¼ä½†æ”¹å˜å…¶éƒ¨åˆ†å€¼æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç»“æ„ä½“å®ä¾‹é€šå¸¸æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚è¿™å¯ä»¥é€šè¿‡ ç»“æ„ä½“æ›´æ–°è¯­æ³•ï¼ˆstruct update syntaxï¼‰å®ç°ã€‚
    let user2 = User{
        active: user1.active,
        username: user1.username,
        email: String::from("another@example.com"),
        sign_in_count: user1.sign_in_count, 
    };
    //æ­¤å¤„éœ€æ³¨æ„ï¼Œç»“æ„æ›´æ–°è¯­æ³•å°±åƒå¸¦æœ‰ = çš„èµ‹å€¼ å› ä¸ºå®ƒç§»åŠ¨äº†æ•°æ®ï¼Œå°±åƒæˆ‘ä»¬ä¸Šä¸€ç« èŠ‚ 4.1æ‰€æœ‰æƒè®²çš„â€œå˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼ˆä¸€ï¼‰ï¼šç§»åŠ¨â€éƒ¨åˆ†è®²åˆ°çš„ä¸€æ ·
    //å¦‚æœæˆ‘ä»¬è®²user1çš„ usernameæˆ–è€…email ç»™ user2 ï¼Œé‚£ä¹ˆuser1çš„è¿™ä¸¤ä¸ªå±æ€§éƒ½ä¸èƒ½å†ä½¿ç”¨ å› ä¸ºä»–ä»¬è¢«ç§»åŠ¨åˆ°äº†user2 ï¼ˆå› ä¸ºä»–ä»¬æ˜¯Stringç±»å‹çš„
    //è€Œ sign_in_count è·Ÿ active åˆ™ä¸ä¼š å› ä¸ºä»–ä»¬çš„ç±»å‹æ˜¯ å®ç° Copy trait çš„ç±»å‹æ‰€ä»¥æˆ‘ä»¬åœ¨â€œå˜é‡ä¸æ•°æ®äº¤äº’çš„æ–¹å¼ï¼ˆäºŒï¼‰ï¼šå…‹éš†â€ éƒ¨åˆ†è®¨è®ºçš„è¡Œä¸ºåŒæ ·é€‚ç”¨ã€‚
    println!("user email : {}", user1.username);
}

fn learn_struct_back(email: String, username: String) -> User {
    // User {
    //     email: email,
    //     username: username,
    //     active: true,
    //     sign_in_count: 1,
    // }
    //æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ å­—æ®µåˆå§‹åŒ–ç®€å†™è¯­æ³•ï¼ˆfield init shorthandï¼‰æ¥é‡å†™ build_user
    User {
        email,
        username,
        active: true,
        sign_in_count: 1,
    }
}

fn main() {
    println!("Hello, world!");
    learn_struct();
}
